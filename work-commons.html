<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Commons Clinic - Bella Wood</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* Font Faces */
    @font-face {
      font-family: 'PPNeueMontreal';
      src: url('font/PPNeueMontreal-Book.otf') format('opentype');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    @font-face {
      font-family: 'Satoshi';
      src: url('font/Satoshi-Regular.otf') format('opentype');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    @font-face {
      font-family: 'Satoshi';
      src: url('font/Satoshi-Medium.otf') format('opentype');
      font-weight: 500;
      font-style: normal;
      font-display: swap;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Satoshi', 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.8;
      color: #2c2c2c;
      background: #f5f3f0;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    html {
      scroll-behavior: smooth;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', Arial, sans-serif;
      font-weight: 300;
      letter-spacing: 0.03em;
    }

    .project-page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 80px 40px;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.875rem;
      text-decoration: none;
      color: #2c2c2c;
      margin-bottom: 60px;
      transition: opacity 0.3s ease;
    }

    .back-link:hover {
      opacity: 0.6;
    }

    .project-meta {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: #888;
      margin-bottom: 16px;
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
    }

    .project-title {
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 24px;
      letter-spacing: -0.02em;
    }

    .project-description {
      font-size: 1rem;
      line-height: 1.3;
      color: #4a4a4a;
      margin-bottom: 60px;
    }

    .project-hero-image {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 80px;
    }

    .project-content {
      /* Full width to allow images to span like hero/details box */
    }

    /* Text elements */
    .project-content h2,
    .project-content h3,
    .project-content p,
    .project-content ul,
    .project-content ol,
    .project-content blockquote,
    .project-content .callout,
    .project-content .external-links {
    }

    .project-content h2 {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 16px;
      margin-top: 40px;
    }

    .project-content h2:first-child {
      margin-top: 0;
    }

    .project-content h3 {
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 10px;
      margin-top: 24px;
      letter-spacing: 0.02em;
    }

    .project-content p {
      font-size: 1.1rem;
      line-height: 1.8;
      margin-bottom: 16px;
      color: #4a4a4a;
    }

    .project-content .lead-question {
      font-size: 1.35rem;
      font-style: italic;
      line-height: 1.5;
      color: #2c2c2c;
      margin-bottom: 16px;
    }

    .project-content .callout {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', Arial, sans-serif;
      font-size: 1.3rem;
      font-weight: 300;
      line-height: 1.6;
      color: #2c2c2c;
      padding: 20px 0;
      margin-top: 20px;
      margin-bottom: 20px;
      border-top: 1px solid rgba(0,0,0,0.1);
      border-bottom: 1px solid rgba(0,0,0,0.1);
      letter-spacing: 0.01em;
    }

    .project-content .definition {
      margin-bottom: 16px;
      font-size: 1.1rem;
      line-height: 1.8;
      color: #4a4a4a;
    }

    .project-content .definition strong {
      color: #2c2c2c;
    }

    /* Content images: full width */
    .project-content .content-image {
      width: 100%;
      border-radius: 8px;
      display: block;
      margin: 20px auto;
    }

    .project-content .content-images-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      max-width: 700px;
      margin: 32px auto;
    }

    .project-content .content-images-row img {
      width: 100%;
      border-radius: 8px;
      display: block;
    }

    .project-content .content-images-quad {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      max-width: 700px;
      margin: 32px auto;
    }

    .project-content .content-images-quad img {
      width: 100%;
      border-radius: 8px;
      display: block;
    }

    .placeholder-notice {
      background: #fff;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    }

    .placeholder-notice p {
      color: #888;
      font-style: italic;
    }

    .project-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 24px;
      margin-bottom: 48px;
      padding: 32px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    }

    .detail-item {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .detail-label {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: #888;
    }

    .detail-value {
      font-size: 1rem;
      color: #2c2c2c;
    }

    .project-header {
      grid-column: 1 / -1;
      padding-bottom: 24px;
      border-bottom: 1px solid rgba(0,0,0,0.08);
    }

    .project-header .project-description {
      margin-bottom: 0;
    }

    .project-content ul {
      list-style: none;
      padding-left: 0;
      margin-bottom: 24px;
      margin-top: 0;
    }

    .project-content ul li {
      font-size: 1.1rem;
      line-height: 1.8;
      color: #4a4a4a;
      padding-left: 20px;
      position: relative;
      margin-bottom: 8px;
    }

    .project-content ul li::before {
      content: '\2014';
      position: absolute;
      left: 0;
      color: #888;
    }

    .external-links {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 40px;
    }

    .external-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 20px;
      background: #2c2c2c;
      color: #f5f3f0;
      text-decoration: none;
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.85rem;
      border-radius: 6px;
      transition: opacity 0.3s ease;
    }

    .external-link:hover {
      opacity: 0.8;
    }

    /* Carousel */
    .carousel {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      margin: 20px auto;
      border-radius: 8px;
      overflow: hidden;
      background: #eae8e5;
    }

    .carousel-slide {
      position: absolute;
      inset: 0;
      display: none;
    }

    .carousel-slide.active {
      display: block;
    }

    .carousel-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(44, 44, 44, 0.85);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      cursor: pointer;
      z-index: 10;
      color: #fff;
    }

    .carousel-btn:hover {
      background: rgba(44, 44, 44, 1);
    }

    .carousel-btn.prev { left: 12px; }
    .carousel-btn.next { right: 12px; }

    .carousel-btn svg {
      width: 18px;
      height: 18px;
    }

    .carousel-dots {
      position: absolute;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 10;
    }

    .carousel-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      border: none;
      padding: 0;
      cursor: pointer;
    }

    .carousel-dot.active {
      background: #fff;
    }

    @media (max-width: 768px) {
      .carousel-btn {
        width: 36px;
        height: 36px;
      }

      .carousel-btn.prev { left: 8px; }
      .carousel-btn.next { right: 8px; }

      .carousel-btn svg {
        width: 16px;
        height: 16px;
      }
    }

    .carousel-expand {
      display: none;
    }

    @media (max-width: 768px) {
      .carousel-expand {
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        bottom: 12px;
        right: 12px;
        width: 36px;
        height: 36px;
        background: rgba(44, 44, 44, 0.85);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        cursor: pointer;
        z-index: 10;
        color: #fff;
      }

      .carousel-expand svg {
        width: 16px;
        height: 16px;
      }
    }

    /* Hover reveal image */
    .hover-reveal {
      position: relative;
      width: 100%;
      margin: 20px auto;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
    }

    .hover-reveal img {
      width: 100%;
      display: block;
      border-radius: 8px;
    }

    .hover-reveal .hover-state {
      position: absolute;
      inset: 0;
      opacity: 0;
    }

    .hover-reveal:hover .hover-state {
      opacity: 1;
    }

    .hover-reveal.tapped .hover-state {
      opacity: 1;
    }

    .hover-reveal-label {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: #888;
      margin-bottom: 8px;
      margin-top: 20px;
    }

    .mobile-only { display: none; }
    .reveal-btn {
      display: none;
    }

    @media (max-width: 768px) {
      .desktop-only { display: none; }
      .mobile-only { display: inline; }
      .hover-reveal-label { display: none; }

      .hover-reveal:hover .hover-state {
        opacity: 0;
      }

      .hover-reveal.tapped .hover-state {
        opacity: 1;
      }

      .reveal-btn {
        display: block;
        margin: 16px auto 0;
        padding: 12px 24px;
        font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        background: #2c2c2c;
        color: #fff;
        border: none;
        border-radius: 8px;
        cursor: pointer;
      }

      .reveal-btn:hover {
        background: #1a1a1a;
      }

      .reveal-expand {
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        bottom: 12px;
        right: 12px;
        width: 36px;
        height: 36px;
        background: rgba(44, 44, 44, 0.85);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        cursor: pointer;
        z-index: 10;
        color: #fff;
      }

      .reveal-expand svg {
        width: 16px;
        height: 16px;
      }
    }

    /* Three-up row, carousel on mobile */
    .three-up {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 16px;
      margin: 32px auto;
    }

    .three-up img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
      display: block;
    }

    .three-up-mobile {
      display: none;
    }

    @media (max-width: 768px) {
      .three-up {
        display: none;
      }

      .three-up-mobile {
        display: block;
      }
    }

    .carousel-label {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: #888;
      margin-bottom: 12px;
    }

    /* Strategy SVG buttons */
    .strategy-buttons {
      display: flex;
      gap: 24px;
      margin: 20px 0;
    }

    .strategy-btn {
      flex: 1;
      cursor: pointer;
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 0;
      background: none;
      transition: border-color 0.25s ease, opacity 0.25s ease;
      overflow: hidden;
    }

    .strategy-btn img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 10px;
    }

    .strategy-btn:hover {
      opacity: 0.85;
    }

    .strategy-btn.active {
      border-color: #2c2c2c;
    }

    .strategy-panel {
      display: none;
      margin: 0 0 20px;
    }

    .strategy-panel.active {
      display: block;
    }

    .strategy-panel img {
      width: 100%;
      border-radius: 8px;
      display: block;
      margin-top: 12px;
    }

    @media (max-width: 768px) {
      .strategy-buttons {
        gap: 8px;
      }

      .strategy-btn {
        border-radius: 8px;
        border-width: 1.5px;
      }

      .strategy-btn img {
        border-radius: 6px;
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
      }
    }

    /* Lightbox */
    .lightbox-overlay {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 2000;
      background: rgba(0, 0, 0, 0.9);
      align-items: center;
      justify-content: center;
      padding: 24px;
      cursor: zoom-out;
    }

    .lightbox-overlay.active {
      display: flex;
    }

    .lightbox-overlay img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border-radius: 4px;
    }

    .lightbox-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.15);
      border: none;
      border-radius: 50%;
      color: #fff;
      font-size: 1.25rem;
      cursor: pointer;
      z-index: 2001;
    }

    .lightbox-nav {
      display: none;
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 44px;
      height: 44px;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.15);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      z-index: 2001;
      color: #fff;
    }

    .lightbox-overlay.carousel-mode .lightbox-nav {
      display: flex;
    }

    .lightbox-prev { left: 16px; }
    .lightbox-next { right: 16px; }

    .lightbox-nav svg {
      width: 20px;
      height: 20px;
    }

    .lightbox-dots {
      display: none;
      position: absolute;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      gap: 8px;
      z-index: 2001;
    }

    .lightbox-overlay.carousel-mode .lightbox-dots {
      display: flex;
    }

    .lightbox-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      border: none;
      padding: 0;
      cursor: pointer;
    }

    .lightbox-dot.active {
      background: #fff;
    }

    .lightbox-counter {
      display: none;
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.6);
      z-index: 2001;
    }

    .lightbox-overlay.carousel-mode .lightbox-counter {
      display: block;
    }

    .lightbox-toggle {
      display: none;
      position: absolute;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 24px;
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
      border: none;
      border-radius: 100px;
      cursor: pointer;
      z-index: 2001;
      white-space: nowrap;
    }

    .lightbox-overlay.reveal-mode .lightbox-toggle {
      display: block;
    }

    .lightbox-overlay.reveal-mode .lightbox-dots,
    .lightbox-overlay.reveal-mode .lightbox-counter {
      display: none;
    }

    @media (max-width: 768px) {
      .project-content .content-image,
      .strategy-panel img {
        border-radius: 0;
        margin-left: -24px;
        margin-right: -24px;
        width: calc(100% + 48px);
        max-width: none;
        cursor: zoom-in;
      }

      .carousel {
        border-radius: 0;
        margin-left: -24px;
        margin-right: -24px;
        width: calc(100% + 48px);
      }

      .carousel-slide img {
        cursor: zoom-in;
      }
    }

    /* Jump-to links */
    .jump-to {
      margin: 24px 0;
    }

    .jump-to-label {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: #888;
      margin-bottom: 10px;
    }

    .jump-to-links {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .jump-to a {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.8rem;
      text-decoration: none;
      color: #2c2c2c;
      border: 1px solid rgba(44, 44, 44, 0.25);
      border-radius: 100px;
      padding: 6px 14px;
      opacity: 0.75;
      transition: opacity 0.25s ease;
      white-space: nowrap;
    }

    .jump-to a:hover {
      opacity: 1;
    }

    .figma-embed {
      width: 100%;
      max-width: 1200px;
      margin: 24px auto;
      display: block;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .figma-embed iframe {
      width: 100%;
      height: 600px;
      border: none;
      display: block;
    }

    @media (max-width: 768px) {
      .figma-embed iframe {
        height: 400px;
      }
    }

    @media (max-width: 768px) {
      .project-page {
        padding: 60px 24px;
      }

      .project-details {
        padding: 20px;
        gap: 16px;
      }

      .project-hero-image {
        margin-bottom: 32px;
      }

      .project-title {
        font-size: 2rem;
      }

      .project-content .content-images-row,
      .project-content .content-images-quad {
        grid-template-columns: 1fr;
      }

      .project-content h2 {
        font-size: 1.25rem;
        line-height: 1.3;
        margin-top: 32px;
        margin-bottom: 12px;
      }

      .project-content p {
        font-size: 1em;
        line-height: 1.2em;
      }

      .project-content ul li {
        font-size: 1em;
        line-height: 1.2em;
      }

      .project-content .lead-question {
        font-size: 1.1rem;
      }

      .project-content .callout {
        font-size: 1.15rem;
      }
    }

    /* Project Navigation */
    .project-nav {
      display: flex;
      justify-content: space-between;
      margin-top: 80px;
      padding-top: 40px;
      border-top: 1px solid rgba(0,0,0,0.1);
    }

    .project-nav a {
      text-decoration: none;
      color: #2c2c2c;
      transition: opacity 0.3s ease;
    }

    .project-nav a:hover {
      opacity: 0.6;
    }

    .nav-prev {
      text-align: left;
    }

    .nav-next {
      text-align: right;
    }

    .nav-label {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: #888;
      display: block;
      margin-bottom: 4px;
    }

    .nav-title {
      font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif;
      font-size: 0.9rem;
      color: #2c2c2c;
    }

    @media (max-width: 768px) {
      .project-nav {
        flex-direction: row;
        gap: 16px;
        margin-bottom: 80px;
      }

      .nav-prev, .nav-next {
        flex: 1;
      }
    }
    /* Navigation Bar */
    .nav-bar {
      position: fixed;
      top: 24px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 500;
      padding: 10px 24px;
      display: flex;
      align-items: center;
      background: rgba(245, 243, 240, 0.7);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 100px;
      border: 1px solid rgba(0, 0, 0, 0.06);
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .nav-link {
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      color: #2c2c2c;
      transition: opacity 0.3s ease;
      padding: 4px;
    }

    .nav-link:hover {
      opacity: 0.6;
    }

    .nav-link svg {
      width: 20px;
      height: 20px;
    }

    @media (max-width: 768px) {
      .nav-bar {
        top: auto;
        bottom: 18px;
        left: 18px;
        right: 18px;
        transform: none;
        justify-content: center;
      }

      .nav-links {
        gap: 32px;
      }

      .nav-link svg {
        width: 22px;
        height: 22px;
      }
    }

    /* Back to Top Button */
    .back-to-top {
      position: fixed;
      bottom: 32px;
      right: 32px;
      z-index: 600;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(245, 243, 240, 0.7);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 50%;
      border: 1px solid rgba(0, 0, 0, 0.06);
      cursor: pointer;
      text-decoration: none;
      color: #2c2c2c;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .back-to-top.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .back-to-top:hover {
      opacity: 0.6;
    }

    .back-to-top svg {
      width: 18px;
      height: 18px;
    }

    @media (max-width: 768px) {
      .back-to-top {
        bottom: 80px;
        right: 18px;
      }
    }
    /* Password Protection */
    body:not(.pw-auth) > *:not(.pw-overlay):not(script) { display: none !important; }
    .pw-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); align-items: center; justify-content: center; z-index: 1000; }
    body:not(.pw-auth) .pw-overlay { display: flex; }
    .pw-modal { background: #fff; border-radius: 16px; padding: 28px; max-width: 400px; width: 90%; text-align: left; box-shadow: 0 20px 60px rgba(0,0,0,0.15); }
    .pw-modal h3 { font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif; font-size: 1.5rem; font-weight: 500; margin-bottom: 12px; }
    .pw-modal p { font-size: 0.95rem; color: #6b6b6b; margin-bottom: 32px; line-height: 1.6; }
    .pw-modal input { width: 100%; padding: 16px 20px; font-size: 1rem; border: 1px solid rgba(0,0,0,0.15); border-radius: 8px; font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif; outline: none; margin-bottom: 16px; transition: border-color 0.3s ease, box-shadow 0.3s ease; }
    .pw-modal input:focus { border-color: #2c2c2c; box-shadow: 0 0 0 3px rgba(44,44,44,0.1); }
    .pw-modal input.error { border-color: #e74c3c; box-shadow: 0 0 0 3px rgba(231,76,60,0.1); }
    .pw-modal button { width: 100%; padding: 16px 20px; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.1em; background: #2c2c2c; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-family: 'PPNeueMontreal', 'Helvetica Neue', sans-serif; transition: background 0.3s ease; }
    .pw-modal button:hover { background: #1a1a1a; }
    .pw-modal .pw-error { color: #e74c3c; font-size: 0.85rem; margin-top: 12px; opacity: 0; transition: opacity 0.3s ease; }
    .pw-modal .pw-error.visible { opacity: 1; }
    @media (max-width: 768px) {
      .pw-modal { padding: 20px; }
      .pw-modal p { margin-bottom: 20px; }
      .pw-modal input { padding: 12px 16px; margin-bottom: 12px; }
      .pw-modal button { padding: 12px 16px; }
    }
  </style>
</head>
<body>
  <script>if(sessionStorage.getItem('portfolio_authenticated')==='true')document.body.classList.add('pw-auth');</script>
  <div class="pw-overlay"><div class="pw-modal"><h3>Enter Password</h3><p>This project is password protected.</p><input type="password" id="pwInput" placeholder="Password" autocomplete="off"><button id="pwSubmit">Submit</button><p class="pw-error" id="pwError">Incorrect password. Please try again.</p></div></div>
  <script>(function(){if(sessionStorage.getItem('portfolio_authenticated')==='true')return;var i=document.getElementById('pwInput'),b=document.getElementById('pwSubmit'),e=document.getElementById('pwError');function c(){if(i.value==='Matchalatte'){sessionStorage.setItem('portfolio_authenticated','true');document.body.classList.add('pw-auth');}else{i.classList.add('error');e.classList.add('visible');i.select();}}b.addEventListener('click',c);i.addEventListener('keypress',function(ev){if(ev.key==='Enter')c();});i.addEventListener('input',function(){i.classList.remove('error');e.classList.remove('visible');});setTimeout(function(){i.focus();},100);})();</script>
  <!-- Navigation Bar -->
  <nav class="nav-bar">
    <div class="nav-links">
      <a href="index.html" class="nav-link" title="Home">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
      </a>
      <a href="index.html#work" class="nav-link" title="Work">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
          <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
        </svg>
      </a>
      <a href="index.html#about" class="nav-link" title="About">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
      </a>
      <a href="index.html#articles" class="nav-link" title="Articles">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
          <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
        </svg>
      </a>
      <a href="index.html#contact" class="nav-link" title="Contact">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
          <polyline points="22,6 12,13 2,6"></polyline>
        </svg>
      </a>
    </div>
  </nav>

  <main class="project-page">
    <a href="index.html" class="back-link">&larr; Back to Work</a>

    <img src="images/product/CC_Presentation/CC_JPG 1.png" alt="Commons Clinic presentation cover" class="project-hero-image">

    <div class="project-details">
      <div class="project-header">
        <p class="project-meta">UX Research &middot; Product Design &middot; Prototyping &middot; Figma</p>
        <h1 class="project-title">Commons Clinic</h1>
        <p class="project-description">I conducted competitor UX flow analysis, led light UX research using AI, translated insights into actionable design decisions, and presented findings, concepts, and future brand direction to stakeholders.</p>
      </div>
      <div class="detail-item">
        <span class="detail-label">Year</span>
        <span class="detail-value">2025</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Industry</span>
        <span class="detail-value">Healthcare</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Designer</span>
        <span class="detail-value">Bella Wood</span>
      </div>
    </div>

    <div class="project-content">

      <img src="images/product/CC_Presentation/CC_JPG 2.png" alt="Project overview: turning a website into a product" class="content-image">

      <div class="jump-to">
        <p class="jump-to-label">Jump to:</p>
        <div class="jump-to-links">
          <a href="#goals">Goals</a>
          <a href="#ux-research">UX Research</a>
          <a href="#actionable-insights">Actionable Insights</a>
          <a href="#design-prototype">Design &amp; Prototype</a>
        </div>
      </div>

      <!-- Step 1: Context, Goals & Product Definition -->
      <h2 id="goals">Step 1: Understanding the challenge</h2>
      <img src="images/product/CC_Presentation/CC_JPG 3.png" alt="Context, goals and product definition section" class="content-image">
      <h3>Behind any good design, is strategy.</h3>
      <p>Before moving into design, I laid the groundwork to understand and solve the ask at hand. A strong product experience starts with:</p>

      <div class="strategy-buttons">
        <button class="strategy-btn active" data-panel="strategyPanel1"><img src="images/product/CC_Presentation/1.svg" alt="Understanding the Stakeholder and Business Goals"></button>
        <button class="strategy-btn" data-panel="strategyPanel2"><img src="images/product/CC_Presentation/2.svg" alt="The Difference Between a Website and a Digital Product"></button>
        <button class="strategy-btn" data-panel="strategyPanel3"><img src="images/product/CC_Presentation/3.svg" alt="User Behavior + Competitor Approaches to UX"></button>
      </div>

      <div class="strategy-panel active" id="strategyPanel1">
        <img src="images/product/CC_Presentation/CC_JPG 5.png" alt="Understanding stakeholder and business goals">
      </div>
      <div class="strategy-panel" id="strategyPanel2">
        <img src="images/product/CC_Presentation/CC_JPG 6.png" alt="The difference between a website and a digital product">
      </div>
      <div class="strategy-panel" id="strategyPanel3">
        <img src="images/product/CC_Presentation/CC_JPG 7.png" alt="Chosen UX research methods overview">
        <img src="images/product/CC_Presentation/CC_JPG 8.png" alt="Competitor UX analysis approach">
      </div>

      <!-- Step 2: User Research & Flow Analysis -->
      <h2 id="ux-research">Step 2: UX Research</h2>
      <p>With the stakeholder goals defined and the task understood, I can move into executing the two research methods I chose to guide the design direction: user flows and competitor UX/UI analysis.</p>
      <img src="images/product/CC_Presentation/CC_JPG 9.png" alt="User research and flow analysis section" class="content-image">
      <h3>The Big Question: How do you transform a website into a product experience?</h3>
      <p>You stop designing pages and start designing pathways. Every research finding became a decision&mdash;what to surface, what to simplify, and where to guide the user next. The goal was to close the gap between browsing and doing.</p>

      <h3>Method 1: User Flows</h3>
      <p>I mapped user flows across Commons Clinic, Hims, and Airbnb to compare how each platform guides users toward a clear outcome.</p>

      <p class="hover-reveal-label"><span class="desktop-only">Hover</span><span class="mobile-only">Tap</span> to reveal key insights</p>
      <div class="hover-reveal" id="hoverReveal">
        <img src="images/product/CC_Presentation/CC_JPG 11.png" alt="User flow comparison: Commons Clinic, Hims, Airbnb">
        <img src="images/product/CC_Presentation/CC_JPG 12.png" alt="Key insights from user flows" class="hover-state">
        <button class="reveal-expand" id="revealExpand" aria-label="Expand image"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg></button>
      </div>
      <button class="reveal-btn" id="revealBtn">Reveal Insights</button>
      <h3>Method 2: Competitor UX/UI Analysis</h3>
      <p>Next, I inspected competitor layouts to identify common UX patterns and opportunities Commons Clinic could capitalize on.</p>

      <img src="images/product/CC_Presentation/CC_JPG 13.png" alt="Competitor UX/UI research questions" class="content-image">
      <img src="images/product/CC_Presentation/CC_JPG 14.png" alt="Competitor UX analysis: Airbnb, Uber" class="content-image">
      <img src="images/product/CC_Presentation/CC_JPG 15.png" alt="Competitor UX analysis: Hims, wellness platforms" class="content-image">
      <img src="images/product/CC_Presentation/CC_JPG 16.png" alt="Competitor UX research findings and patterns" class="content-image">

      <!-- Step 3: Insights into Concepts -->
      <h2 id="actionable-insights">Step 3: Insights into Concepts</h2>
      <img src="images/product/CC_Presentation/CC_JPG 17.png" alt="Insights into concepts section" class="content-image">
      <img src="images/product/CC_Presentation/CC_JPG 18.png" alt="How do insights translate into design?" class="content-image">

      <p>Each research insight mapped directly to an actionable design decision.</p>

      <p class="carousel-label">Insight to action mapping &mdash; use arrows to navigate</p>
      <div class="carousel" id="carouselInsights">
        <div class="carousel-slide active"><img src="images/product/CC_Presentation/CC_JPG 19.png" alt="Insights to actions: Search Care Options"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 20.png" alt="Insights to actions: Discover Provider/Physician"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 21.png" alt="Insights to actions: Booking"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 22.png" alt="Insights to actions: Competitor UX/UI analysis"></div>
        <button class="carousel-btn prev" aria-label="Previous slide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg></button>
        <button class="carousel-btn next" aria-label="Next slide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"></polyline></svg></button>
        <button class="carousel-expand" aria-label="Expand image"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg></button>
        <div class="carousel-dots"></div>
      </div>

      <!-- Step 4: Concepts to Layout -->
      <h2 id="design-prototype">Step 4: Concepts to Layout</h2>
      <img src="images/product/CC_Presentation/CC_JPG 23.png" alt="Concepts to layout section" class="content-image">

      <p>I established the brand direction first, then designed every screen of the product experience.</p>
      <p class="carousel-label">Full design decision walkthrough below &mdash; use arrows to navigate</p>
      <div class="carousel" id="carouselDesign">
        <div class="carousel-slide active"><img src="images/product/CC_Presentation/CC_JPG 26.png" alt="Design: Home above the fold"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 27.png" alt="Design: Explore Care Options"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 28.png" alt="Design: Meet the Physicians"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 29.png" alt="Design: Book an Appointment"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 30.png" alt="Design: Patient Stories"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 31.png" alt="Design: Care Guides"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 32.png" alt="Design: Contact"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 33.png" alt="Design: App CTA and Footer"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 34.png" alt="Design: User Profile Pre-Loader"></div>
        <div class="carousel-slide"><img src="images/product/CC_Presentation/CC_JPG 35.png" alt="Design: User Profile dashboard"></div>
        <button class="carousel-btn prev" aria-label="Previous slide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg></button>
        <button class="carousel-btn next" aria-label="Next slide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"></polyline></svg></button>
        <button class="carousel-expand" aria-label="Expand image"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg></button>
        <div class="carousel-dots"></div>
      </div>
      <img src="images/product/CC_Presentation/CC_JPG 24.png" alt="Commons Clinic brand direction" class="content-image">
      <img src="images/product/CC_Presentation/CC_JPG 25.png" alt="Design mockups: laptop and user profile" class="content-image">

      <!-- Interactive Prototype -->
      <h2>Interactive Prototype</h2>
      <p>Click through the prototype below to experience the interactions and hover animations.</p>
      <div class="figma-embed">
        <iframe src="https://www.figma.com/embed?embed_host=share&url=https%3A%2F%2Fwww.figma.com%2Fproto%2FxaPmxlo6CAVgByKd8nKX3H%2FCommons-Clinic-Layout%3Fpage-id%3D0%253A1%26node-id%3D3-394%26viewport%3D902%252C128%252C0.12%26t%3DTlCpc02z78ak4WMs-1%26scaling%3Dscale-down%26content-scaling%3Dfixed" allowfullscreen loading="lazy"></iframe>
      </div>
      <div class="external-links">
        <a href="https://www.figma.com/proto/xaPmxlo6CAVgByKd8nKX3H/Commons-Clinic-Layout?page-id=0%3A1&node-id=3-394&viewport=902%2C128%2C0.12&t=TlCpc02z78ak4WMs-1&scaling=scale-down&content-scaling=fixed" target="_blank" rel="noopener noreferrer" class="external-link">View Prototype <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a>
      </div>

      <!-- Conclusion -->
      <h2>Conclusion</h2>
      <img src="images/product/CC_Presentation/CC_JPG 37.png" alt="Commons Clinic thank you" class="content-image">
      <p>This work repositioned Commons Clinic from a static informational site into the foundation of a <strong>scalable product ecosystem</strong>.</p>
      <p>By combining UX research, product thinking, and thoughtful visual design, I shaped a direction that simplifies the healthcare journey while strengthening trust and clarity.</p>
      <p>The result is not just a redesign. It is a vision for a cohesive, patient-centered digital experience.</p>
    </div>

    <nav class="project-nav">
      <a href="work-skyscanner.html" class="nav-prev">
        <span class="nav-label">&larr; Previous</span>
        <span class="nav-title">Skyscanner UX Research</span>
      </a>
      <a href="work-ford-ds.html" class="nav-next">
        <span class="nav-label">Next &rarr;</span>
        <span class="nav-title">Ford Design System Recreation</span>
      </a>
    </nav>
  </main>
  <div class="lightbox-overlay" id="lightboxOverlay">
    <button class="lightbox-close" aria-label="Close">&times;</button>
    <button class="lightbox-nav lightbox-prev" aria-label="Previous slide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg></button>
    <button class="lightbox-nav lightbox-next" aria-label="Next slide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"></polyline></svg></button>
    <span class="lightbox-counter" id="lightboxCounter"></span>
    <img src="" alt="">
    <div class="lightbox-dots" id="lightboxDots"></div>
    <button class="lightbox-toggle" id="lightboxToggle">Reveal Insights</button>
  </div>
  <a href="#" class="back-to-top" id="backToTop" title="Back to top">
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  </a>
  <script>
    const btn = document.getElementById('backToTop');
    window.addEventListener('scroll', () => {
      btn.classList.toggle('visible', window.scrollY > 300);
    });

    // Carousel functionality
    document.querySelectorAll('.carousel').forEach(carousel => {
      const slides = carousel.querySelectorAll('.carousel-slide');
      const prevBtn = carousel.querySelector('.carousel-btn.prev');
      const nextBtn = carousel.querySelector('.carousel-btn.next');
      const dotsContainer = carousel.querySelector('.carousel-dots');
      let current = 0;

      slides.forEach((_, i) => {
        const dot = document.createElement('button');
        dot.classList.add('carousel-dot');
        if (i === 0) dot.classList.add('active');
        dot.setAttribute('aria-label', 'Go to slide ' + (i + 1));
        dot.addEventListener('click', () => goTo(i));
        dotsContainer.appendChild(dot);
      });

      function goTo(index) {
        slides[current].classList.remove('active');
        current = index;
        slides[current].classList.add('active');
        carousel.querySelectorAll('.carousel-dot').forEach((d, i) => {
          d.classList.toggle('active', i === current);
        });
      }

      // Expose goTo so the lightbox can sync slides back
      carousel._goTo = goTo;

      prevBtn.addEventListener('click', () => goTo(current > 0 ? current - 1 : slides.length - 1));
      nextBtn.addEventListener('click', () => goTo(current < slides.length - 1 ? current + 1 : 0));

      // Touch/swipe support
      let startX = 0;
      let isDragging = false;
      carousel.addEventListener('touchstart', e => { startX = e.touches[0].clientX; isDragging = true; }, { passive: true });
      carousel.addEventListener('touchend', e => {
        if (!isDragging) return;
        isDragging = false;
        const diff = startX - e.changedTouches[0].clientX;
        if (Math.abs(diff) > 50) {
          diff > 0 ? nextBtn.click() : prevBtn.click();
        }
      }, { passive: true });
    });

    // Hover-reveal toggle for mobile
    var revealEl = document.getElementById('hoverReveal');
    var revealBtn = document.getElementById('revealBtn');
    revealBtn.addEventListener('click', function() {
      var active = revealEl.classList.toggle('tapped');
      revealBtn.textContent = active ? 'Show User Flows' : 'Reveal Insights';
    });

    // Strategy SVG button panels
    document.querySelectorAll('.strategy-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        var panelId = btn.getAttribute('data-panel');
        var panel = document.getElementById(panelId);
        var isActive = btn.classList.contains('active');

        // Close all panels and deactivate all buttons
        document.querySelectorAll('.strategy-btn').forEach(function(b) { b.classList.remove('active'); });
        document.querySelectorAll('.strategy-panel').forEach(function(p) { p.classList.remove('active'); });

        // If this one wasn't active, open it
        if (!isActive) {
          btn.classList.add('active');
          panel.classList.add('active');
        }
      });
    });

    // Lightbox for mobile image expand (with carousel navigation + reveal toggle)
    (function() {
      var overlay = document.getElementById('lightboxOverlay');
      var lightboxImg = overlay.querySelector('img');
      var dotsContainer = document.getElementById('lightboxDots');
      var counter = document.getElementById('lightboxCounter');
      var prevNav = overlay.querySelector('.lightbox-prev');
      var nextNav = overlay.querySelector('.lightbox-next');
      var toggleBtn = document.getElementById('lightboxToggle');
      var isMobile = function() { return window.innerWidth <= 768; };

      // Carousel mode state
      var carouselSlides = [];
      var carouselCurrent = 0;
      var sourceCarousel = null;

      // Reveal mode state
      var revealImages = null;
      var revealShowing = 'base'; // 'base' or 'insights'

      function openLightbox(src, alt) {
        // Single image mode
        overlay.classList.remove('carousel-mode');
        overlay.classList.remove('reveal-mode');
        carouselSlides = [];
        sourceCarousel = null;
        revealImages = null;
        dotsContainer.innerHTML = '';
        lightboxImg.src = src;
        lightboxImg.alt = alt || '';
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function openRevealLightbox(showInsights) {
        var hoverReveal = document.getElementById('hoverReveal');
        var baseImg = hoverReveal.querySelector('img:not(.hover-state)');
        var insightsImg = hoverReveal.querySelector('.hover-state');
        revealImages = { base: { src: baseImg.src, alt: baseImg.alt }, insights: { src: insightsImg.src, alt: insightsImg.alt } };
        overlay.classList.remove('carousel-mode');
        overlay.classList.add('reveal-mode');
        carouselSlides = [];
        sourceCarousel = null;
        dotsContainer.innerHTML = '';

        if (showInsights) {
          revealShowing = 'insights';
          lightboxImg.src = revealImages.insights.src;
          lightboxImg.alt = revealImages.insights.alt;
          toggleBtn.textContent = 'Show User Flows';
        } else {
          revealShowing = 'base';
          lightboxImg.src = revealImages.base.src;
          lightboxImg.alt = revealImages.base.alt;
          toggleBtn.textContent = 'Reveal Insights';
        }

        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      // Toggle button in lightbox
      toggleBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        if (!revealImages) return;
        if (revealShowing === 'base') {
          revealShowing = 'insights';
          lightboxImg.src = revealImages.insights.src;
          lightboxImg.alt = revealImages.insights.alt;
          toggleBtn.textContent = 'Show User Flows';
        } else {
          revealShowing = 'base';
          lightboxImg.src = revealImages.base.src;
          lightboxImg.alt = revealImages.base.alt;
          toggleBtn.textContent = 'Reveal Insights';
        }
      });

      function openCarouselLightbox(carousel, startIndex) {
        var slides = carousel.querySelectorAll('.carousel-slide img');
        carouselSlides = [];
        slides.forEach(function(img) {
          carouselSlides.push({ src: img.src, alt: img.alt || '' });
        });
        if (carouselSlides.length === 0) return;
        sourceCarousel = carousel;
        carouselCurrent = startIndex || 0;
        overlay.classList.remove('reveal-mode');
        overlay.classList.add('carousel-mode');
        revealImages = null;
        showCarouselSlide(carouselCurrent);
        buildDots();
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function showCarouselSlide(index) {
        carouselCurrent = index;
        lightboxImg.src = carouselSlides[index].src;
        lightboxImg.alt = carouselSlides[index].alt;
        counter.textContent = (index + 1) + ' / ' + carouselSlides.length;
        updateDots();
        // Sync the source carousel
        if (sourceCarousel) {
          var goTo = sourceCarousel._goTo;
          if (goTo) goTo(index);
        }
      }

      function buildDots() {
        dotsContainer.innerHTML = '';
        carouselSlides.forEach(function(_, i) {
          var dot = document.createElement('button');
          dot.classList.add('lightbox-dot');
          if (i === carouselCurrent) dot.classList.add('active');
          dot.addEventListener('click', function(e) {
            e.stopPropagation();
            showCarouselSlide(i);
          });
          dotsContainer.appendChild(dot);
        });
      }

      function updateDots() {
        var dots = dotsContainer.querySelectorAll('.lightbox-dot');
        dots.forEach(function(d, i) {
          d.classList.toggle('active', i === carouselCurrent);
        });
      }

      prevNav.addEventListener('click', function(e) {
        e.stopPropagation();
        if (carouselSlides.length === 0) return;
        var idx = carouselCurrent > 0 ? carouselCurrent - 1 : carouselSlides.length - 1;
        showCarouselSlide(idx);
      });

      nextNav.addEventListener('click', function(e) {
        e.stopPropagation();
        if (carouselSlides.length === 0) return;
        var idx = carouselCurrent < carouselSlides.length - 1 ? carouselCurrent + 1 : 0;
        showCarouselSlide(idx);
      });

      // Content images + strategy panel images (single image mode)
      document.querySelectorAll('.content-image, .strategy-panel img').forEach(function(img) {
        img.addEventListener('click', function() {
          if (!isMobile()) return;
          openLightbox(img.src, img.alt);
        });
      });

      // Hover-reveal images: open reveal mode on tap
      var hoverReveal = document.getElementById('hoverReveal');
      hoverReveal.querySelectorAll('img').forEach(function(img) {
        img.addEventListener('click', function() {
          if (!isMobile()) return;
          var isInsights = img.classList.contains('hover-state');
          openRevealLightbox(isInsights);
        });
      });

      // Reveal expand button
      document.getElementById('revealExpand').addEventListener('click', function(e) {
        e.stopPropagation();
        var isInsightsShowing = hoverReveal.classList.contains('tapped');
        openRevealLightbox(isInsightsShowing);
      });

      // Carousel slide images (open carousel mode at tapped slide)
      document.querySelectorAll('.carousel').forEach(function(carousel) {
        carousel.querySelectorAll('.carousel-slide img').forEach(function(img, i) {
          img.addEventListener('click', function() {
            if (!isMobile()) return;
            openCarouselLightbox(carousel, i);
          });
        });
      });

      // Carousel expand buttons (open carousel mode at current slide)
      document.querySelectorAll('.carousel-expand').forEach(function(btn) {
        btn.addEventListener('click', function() {
          var carousel = btn.closest('.carousel');
          var slides = carousel.querySelectorAll('.carousel-slide');
          var activeIndex = 0;
          slides.forEach(function(s, i) { if (s.classList.contains('active')) activeIndex = i; });
          openCarouselLightbox(carousel, activeIndex);
        });
      });

      function closeLightbox() {
        overlay.classList.remove('active');
        overlay.classList.remove('carousel-mode');
        overlay.classList.remove('reveal-mode');
        document.body.style.overflow = '';
        carouselSlides = [];
        sourceCarousel = null;
        revealImages = null;
      }

      overlay.addEventListener('click', function(e) {
        // In carousel or reveal mode, don't close when tapping the image
        var isCarouselOrReveal = overlay.classList.contains('carousel-mode') || overlay.classList.contains('reveal-mode');
        if (e.target.classList.contains('lightbox-close') || e.target === overlay) {
          closeLightbox();
        } else if (e.target === lightboxImg && !isCarouselOrReveal) {
          closeLightbox();
        }
      });

      // Swipe support in lightbox
      var lbStartX = 0;
      var lbDragging = false;
      overlay.addEventListener('touchstart', function(e) {
        if (carouselSlides.length === 0) return;
        lbStartX = e.touches[0].clientX;
        lbDragging = true;
      }, { passive: true });
      overlay.addEventListener('touchend', function(e) {
        if (!lbDragging || carouselSlides.length === 0) return;
        lbDragging = false;
        var diff = lbStartX - e.changedTouches[0].clientX;
        if (Math.abs(diff) > 50) {
          if (diff > 0) {
            nextNav.click();
          } else {
            prevNav.click();
          }
        }
      }, { passive: true });
    })();
  </script>
</body>
</html>
